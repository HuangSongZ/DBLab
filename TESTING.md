# 表达式计算测试说明

## 1. 测试目的

本测试旨在比较两种表达式计算方法的性能：
1. 基于树遍历的递归计算方法
2. 基于扁平数组的指令序列方法

通过随机生成的表达式，评估两种方法的计算速度和性能差异。

## 2. 测试环境

- 操作系统: Linux
- 编译器: GCC
- 优化级别: -O2
- 机器信息:
  - CPU: Intel(R)Core(TM)i5-10210UCPU@1.60GHz
  - 内存: 8144092KB

## 3. 测试方法

### 3.1 示例表达式测试

1. **表达式构建**
   - 生成表达式: `(x0 + 2.5) * (x1 - 1.0) / (x2 + x3)`
   - 设置变量值: x0=5.0, x1=3.0, x2=2.0, x3=1.0

2. **测试步骤**
   - 使用树遍历方法计算结果
   - 将表达式编译为扁平化指令序列
   - 使用扁平数组方法计算结果
   - 验证两种方法的结果一致性

### 3.2 性能对比测试

1. **随机表达式生成**
   - 使用递归算法生成随机表达式树
   - 控制参数:
     - 最大深度: 5
     - 叶子节点生成概率: 30%
     - 常量值范围: 0.0 - 10.0

2. **测试流程**
   - 执行5次独立测试
   - 每次测试:
     1. 生成随机表达式
     2. 编译为扁平化指令序列
     3. 预热计算（各方法执行1次）
     4. 树遍历方法性能测试（执行100万次）
     5. 扁平数组方法性能测试（执行100万次）
     6. 记录执行时间

3. **性能指标**
   - 单次测试时间（秒）
   - 性能提升百分比: (tree_time - flat_time) / tree_time * 100.0
   - 平均执行时间
   - 平均性能提升

## 4. 测试结果

测试结果将输出以下信息：

1. 示例表达式计算结果
2. 扁平化指令序列
3. 每次性能测试的详细信息
4. 总结统计

## 5. 测试脚本

测试通过以下命令执行：
```bash
cd ~/expr_demo
make
./expr_demo
```

